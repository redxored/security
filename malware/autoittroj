autoit trojan
imports
    wsock.dll
    winmm.dll
    mpr.dll
    wininet.dll
    psapi.dll  
    usernv.dll
    version.dll
    comctl32.dll
    kernel32.dll
    user32.dll
    gdi32.dll
    comdlg32.dll
    avapi32.dll
    shell32.dll
    ole32.dll
    oleauth32.dll
    user32.ll
Strings
    user32.dll
    accesses wow64
    WinNm.dll
    icmp.dll
    ascii,14,-,x,IcmpCreateFile
    WNetUseConnection
    InternetOpen
    InternetOpenUrl
    InternetReadFile
    FtpOpenFile
   
#communicates over ftp and http
creates and reads files
    EnumProcesses
#enumerates processes
#   IsDebuggerPresent
    anti debugging tricks
    OpenProcess
    ReadProcessMemory
    WriteProcessMemory
   
    CreateFile
    WriteFile
    LoadResource
 
    CreatePipe 
    MapVirtualKey
    GetKeyboardState
    CreateHardLink
    VkKeyScan
    SetKeyboardState
    Send Message
    keybd_event
 
#possible keylogging
#creates symbolic link
   
    CreateProcessAsUser
    CreateProcessWithLogon 
    RegisterHotKey
    LogonUser
    RegOpenKeyEx
    RegQueryValueEx
    RegCreateKeyEx
    RegDeleteKey
    Delete Key
    DeleteValues
#could create a fake reg key for legtit process and deletes the old one
    OpenSCManager
    LockServiceDatabase
    CloseServiceHandle
    messies with service control
    RegConnectRegistry
    AutoIt v3
    REGWRITE
    .lnk
    visualc++ and autoit combo
    automates browser
    msctf microsoft text services
`   NSI      773A0000
    lpk does shit with browsers
`   RPCRT4   76AF0000 rpc controls
   
    .orpc unusual section stores ole rpc related code
    00402044   . 68 FC4D4800    PUSH citadel.00484DFC                    ; |Arg1 = 00484DFC
    edi cmd line
    ok so ollydbg and immunity don't support autoit
   
    reading orpc section
   
    ok
    eax - 80
    rpcuuidcreate(eax)
    exception handler
    dex ebx
    interlock decrement runs thread
    interlock increment
    like 20 times
    eax + 78
    rpcgetbufferiwithobject
    edi = whatever is sent
    rpcsend(edi)
    eax = x
    rpcrecieve(eax)
    edi = whatever
    rpcsendrecieve(edi)
    more thread operations
    75D4D45C   68 7896C475      PUSH ole32.75C49678                              ; ASCII "gChannelInitLock"
 
    75D4D466   68 CC6FC675      PUSH ole32.75C66FCC                              ; ASCII "d:\w7rtm\com\ole32\com\dcomrem\channelb.cxx"
 
 
    time to run it and see
    deletes itself right after ran
    ifqo.exe
    HKCU\Software\Microsoft\Windows\Currentversion\Run creates key
    HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Agpeopycp
    C:\Windows\system32\wbem\wmiprvse.exe
    it could be querying this
    C:\Users\sam\AppData\Roaming\Mozilla\Firefox\Profiles\ykto6q96.default\formhistory.sqlite
    its it this is the trojan
    creates this file C:\Users\sam\AppData\Roaming\Weanxy\vyiwu.tmp
    C:\Users\sam\AppData\Roaming\Nuxu\moyl.paq
    command and control sam-PC:60648 -> static.30.202.243.136.clients.your-server.de:http
    more strings than last time almost 9000
    it also creates it fuck
   
    loads image C:\Windows\SysWOW64\dllhost.exe
    i opened the tmp file it looks chinese lol,
    creates listeners in 19274
    15038
    rassaddnotification from rasman is one of the running threads
    remote access service
    HKLM\SOFTWARE\Wow6432Node\Microsoft\Tracing\ifqo_RASMANCS
    C:\Users\sam\AppData\Local\Microsoft\Windows\Explorer\thumbcache_1024.db backups
    C:\Users\sam\AppData\Roaming\Microsoft\Windows\Cookies\index.dat
    HKLM\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\MAIN\FeatureControl\FEATURE_HTTP_USERNAME_PASSWORD_DISABLE   
    HKLM\SOFTWARE\Wow6432Node\Microsoft\Tracing\ifqo_RASMANCS
    \Device\Nsi
    \Device\KsecDD
    \Device\Afd
1`  C:\Windows\System32\ntoskrnl.exe
    C:\Windows\System32\csrsrv.dll
    C:\Windows\SysWOW64\apisetschema.dll
    C:\Windows\Servicing\TrustedInstaller.exe
    C:\Windows\SysWOW64\ntkrnlpa.exe
    C:\Windows\System32\rstrui.exe
    C:\Windows\System32\srclient.dll
    C:\Windows\System32\srcore.dll
TrustedInstaller.exe
    strings
        unicode,12,-,-,\cbscore.dll
        \wrpint.dll
        makecab.exe
        SxsStore.dll
C:\Program Files (x86)\Internet Explorer\en-US\iexplore.exe.mui
        C:\Program Files (x86)\Windows Media Player\wmplayer.exe   
 
       
           
    C:\Windows\Logs\CBS\CBS.log
    C:\Windows\winsxs\ManifestCache\ee9f676b8aa4122b_blobs.bin
    HKLM\COMPONENTS\CanonicalData\Deployments
    C:\Windows\winsxs\amd64_microsoft-windows-servicingstack_31bf3856ad364e35_6.1.7601.17514_none_678566b7ddea04a5\WcmTypes.xsd
    creates a fake audio driver
dropped files
C:\Windows\System32\sxssrv.dll
C:\Windows\System32\csrsrv.dll
C:\Windows\AppPatch\sysmain.sdb
C:\Windows\SysWOW64\msobjs.dll
C:\Windows\SysWOW64\schannel.dll
C:\Windows\SysWOW64\adtschema.dll
C:\Windows\winsxs\wow64_microsoft-windows-security-ntlm_31bf3856ad364e35_6.1.7601.18606_none_e53a5832ad813cd9\msv1_0.dll
C:\Windows\winsxs\x86_microsoft-windows-msauditevtlog_31bf3856ad364e35_6.1.7601.18717_none_c94cd21bd6acedbb\msaudite.dll
CreateFile
 
C:\Windows\SysWOW64\en-US\msobjs.dll.mui
C:\Windows\System32\cdosys.dll
C:\Program Files (x86)\Common Files\System\ado
C:\Program Files (x86)\Common Files\System\ado\msado25.tlb
C:\Program Files (x86)\Common Files\System\ado\msadomd.dll
C:\Program Files (x86)\Common Files\System\ado\msador15.dll
C:\Program Files (x86)\Common Files\System\ado\msado28.tlb
C:\Program Files (x86)\Common Files\System\ado\msadox.dll
 
C:\Program Files (x86)\Common Files\System\ado\msjro.dll
 
C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.Web.RegularExpressions.dll
C:\Windows\System32\clfs.sys
C:\Windows\System32\clfsw32.dll
C:\Windows\System32\drivers\mrxsmb20.sys
C:\Windows\System32\localspl.dll
C:\Windows\System32\cscript.exe
C:\Windows\System32\wscript.exe
C:\Windows\System32\wshom.ocx
C:\Windows\SysWOW64\cscript.exe
C:\Windows\System32\certenc.dll
C:\Windows\System32\certutil.exe
C:\Program Files (x86)\Common Files\System\ado\msjro.dll
C:\Program Files (x86)\Common Files\System\msadc\msadco.dll
C:\Windows\SysWOW64\VIDRESZR.DLL
C:\Windows\SysWOW64\mfps.dll
C:\Windows\SysWOW64\MP4SDECD.DLL
C:\Windows\SysWOW64\qasf.dll
C:\Windows\SysWOW64\quartz.dll
C:\Windows\SysWOW64\devenum.dll
C:\Windows\SysWOW64\ksproxy.ax
C:\Windows\SysWOW64\RESAMPLEDMO.DLL
C:\Windows\System32\pku2u.dll
C:\Windows\System32\drivers\partmgr.sys
C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.DirectoryServices.dll
